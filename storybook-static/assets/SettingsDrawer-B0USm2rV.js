import{j as e}from"./jsx-runtime-D_zvdyIk.js";import{r as c}from"./iframe-d2sodY_R.js";import{g as F,S as V,C as K,a as o}from"./index-YHEJibdA.js";import{S as W}from"./SupportLink-C9YXK4qC.js";import{A as H}from"./index-pUis7lPG.js";import{m as l}from"./proxy-oLp51Ffe.js";import{S as _,L as I,M as Z,H as X,Z as B}from"./zap-BOWfXx7X.js";import{X as b}from"./x-gYhyWlMT.js";import{c as J}from"./createLucideIcon-B5oPKDXb.js";import{D as Q}from"./download-DQ1P-CAn.js";import{P as O}from"./plus-BsDFT6l8.js";import{C as Y,a as ee}from"./clock-DWTjRa6l.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=J("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),se=typeof browser<"u"?browser:chrome,ae=["gtm.js","gtm.dom","gtm.load","page_view","virtualPageView"];function te({isOpen:y,onClose:x,settings:s,onUpdateSettings:m,activeTabId:p,eventCount:g,onExport:f}){var T,L,S,D,P,A,M;const[h,v]=c.useState(""),[R,w]=c.useState(!1),[q,j]=c.useState(!1),[u,N]=c.useState(""),[G,k]=c.useState(null),t=r=>{m(r),p&&se.tabs.sendMessage(p,{type:"UPDATE_SETTINGS",payload:r}).catch(()=>{})},C=()=>{h&&!s.dataLayerNames.includes(h)&&(t({dataLayerNames:[...s.dataLayerNames,h]}),v(""),w(!1))},U=r=>{s.dataLayerNames.length>1&&t({dataLayerNames:s.dataLayerNames.filter(a=>a!==r)})},E=r=>{var i;const a=((i=s.grouping)==null?void 0:i.triggerEvents)||o.triggerEvents;a.includes(r)||t({grouping:{...s.grouping||o,triggerEvents:[...a,r]}}),N(""),j(!1)},$=r=>{var i;const a=((i=s.grouping)==null?void 0:i.triggerEvents)||o.triggerEvents;t({grouping:{...s.grouping||o,triggerEvents:a.filter(n=>n!==r)}})},z=(r,a)=>{t({sourceColors:{...s.sourceColors,[r]:a}})};return e.jsx(H,{children:y&&e.jsxs(e.Fragment,{children:[e.jsx(l.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:x,className:"fixed inset-0 bg-black/50 z-40"}),e.jsxs(l.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"fixed right-0 top-0 h-full w-80 bg-dl-darker border-l border-dl-border z-50 flex flex-col shadow-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-dl-border bg-dl-dark",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_,{className:"w-4 h-4 text-dl-primary"}),e.jsx("h2",{className:"font-semibold text-white",children:"Settings"})]}),e.jsx(l.button,{onClick:x,className:"p-1.5 hover:bg-dl-border rounded-lg transition-colors",whileHover:{scale:1.1},whileTap:{scale:.9},children:e.jsx(b,{className:"w-4 h-4 text-slate-400"})})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-4 space-y-5",children:[(g!==void 0||f)&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider flex items-center gap-2",children:[e.jsx(re,{className:"w-3.5 h-3.5 text-dl-accent"}),"Events Captured"]}),e.jsxs("div",{className:"flex items-center justify-between bg-dl-card rounded px-3 py-2 border border-dl-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl font-bold text-white",children:g??0}),e.jsx("span",{className:"text-xs text-slate-400",children:"events"})]}),f&&e.jsxs(l.button,{onClick:f,disabled:!g||g===0,className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-dl-card hover:bg-dl-border border border-dl-border rounded text-xs text-slate-300 hover:text-white transition-colors disabled:opacity-50 disabled:cursor-not-allowed",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(Q,{className:"w-3.5 h-3.5"}),"Export"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider flex items-center gap-2",children:[e.jsx(I,{className:"w-3.5 h-3.5 text-dl-primary"}),"DataLayer Arrays"]}),e.jsxs("div",{className:"space-y-1.5",children:[s.dataLayerNames.map(r=>{const a=F(r,s.sourceColors||{}),i=G===r;return e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between bg-dl-card rounded px-3 py-2 border border-dl-border group",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l.button,{onClick:()=>k(i?null:r),className:"w-4 h-4 rounded-full border-2 border-white/20 hover:border-white/40 transition-colors",style:{backgroundColor:a},whileHover:{scale:1.1},whileTap:{scale:.9},title:"Change colour"}),e.jsx("code",{className:"text-xs text-dl-accent",children:r})]}),e.jsx(l.button,{onClick:()=>U(r),className:"opacity-0 group-hover:opacity-100 p-1 hover:bg-dl-error/20 rounded transition-all",whileHover:{scale:1.1},whileTap:{scale:.9},disabled:s.dataLayerNames.length<=1,children:e.jsx(b,{className:"w-3 h-3 text-dl-error"})})]}),e.jsx(H,{children:i&&e.jsx(l.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"overflow-hidden",children:e.jsx("div",{className:"flex flex-wrap gap-1.5 p-2 bg-dl-dark rounded border border-dl-border",children:V.map(n=>e.jsx(l.button,{onClick:()=>{z(r,n),k(null)},className:`w-5 h-5 rounded-full border-2 transition-colors ${a===n?"border-white":"border-transparent hover:border-white/40"}`,style:{backgroundColor:n},whileHover:{scale:1.15},whileTap:{scale:.95}},n))})})})]},r)}),R?e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("input",{type:"text",value:h,onChange:r=>v(r.target.value),onKeyDown:r=>r.key==="Enter"&&C(),placeholder:"e.g., dataLayer_v2",className:"flex-1 bg-dl-card border border-dl-border rounded px-2 py-1.5 text-xs text-white placeholder:text-slate-500 focus:border-dl-primary focus:outline-none",autoFocus:!0}),e.jsx(l.button,{onClick:C,className:"p-1.5 bg-dl-success/20 hover:bg-dl-success/30 text-dl-success rounded",whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(K,{className:"w-3.5 h-3.5"})}),e.jsx(l.button,{onClick:()=>{w(!1),v("")},className:"p-1.5 bg-dl-error/20 hover:bg-dl-error/30 text-dl-error rounded",whileHover:{scale:1.05},whileTap:{scale:.95},children:e.jsx(b,{className:"w-3.5 h-3.5"})})]}):e.jsxs(l.button,{onClick:()=>w(!0),className:"w-full flex items-center justify-center gap-1.5 py-1.5 px-3 border border-dashed border-dl-border hover:border-dl-primary text-slate-400 hover:text-dl-primary rounded text-xs transition-colors",whileHover:{scale:1.02},whileTap:{scale:.98},children:[e.jsx(O,{className:"w-3.5 h-3.5"}),"Add DataLayer"]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Display"}),e.jsx(d,{icon:e.jsx(Z,{className:"w-3.5 h-3.5 text-dl-primary"}),label:"Compact Mode",description:"Smaller UI elements",checked:s.compactMode,onChange:()=>t({compactMode:!s.compactMode})}),e.jsx(d,{icon:e.jsx(Y,{className:"w-3.5 h-3.5 text-dl-accent"}),label:"Timestamps",checked:s.showTimestamps,onChange:()=>t({showTimestamps:!s.showTimestamps})}),e.jsx(d,{icon:e.jsx(X,{className:"w-3.5 h-3.5 text-yellow-400"}),label:"Persist Events",description:"Keep across refreshes",checked:s.persistEvents,onChange:()=>t({persistEvents:!s.persistEvents})}),e.jsx(d,{icon:e.jsx(B,{className:"w-3.5 h-3.5 text-dl-accent"}),label:"Console Logging",description:"Log events to browser console",checked:s.consoleLogging,onChange:()=>t({consoleLogging:!s.consoleLogging})}),e.jsx(d,{icon:e.jsx(_,{className:"w-3.5 h-3.5 text-slate-400"}),label:"Debug Logging",description:"Extension debug info",checked:s.debugLogging,onChange:()=>t({debugLogging:!s.debugLogging})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("h3",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider flex items-center gap-2",children:[e.jsx(I,{className:"w-3.5 h-3.5 text-dl-primary"}),"Event Grouping"]}),e.jsx(d,{icon:e.jsx(ee,{className:"w-3.5 h-3.5 text-dl-primary"}),label:"Enable Grouping",checked:((T=s.grouping)==null?void 0:T.enabled)??!1,onChange:()=>{var r;return t({grouping:{...s.grouping||o,enabled:!(((r=s.grouping)==null?void 0:r.enabled)??!1)}})}}),((L=s.grouping)==null?void 0:L.enabled)&&e.jsxs(l.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"space-y-2 pt-2",children:[e.jsxs("div",{className:"flex gap-1.5",children:[e.jsx("button",{onClick:()=>t({grouping:{...s.grouping||o,mode:"time"}}),className:`flex-1 py-1.5 text-xs rounded border transition-colors ${((S=s.grouping)==null?void 0:S.mode)==="time"?"bg-dl-primary/20 border-dl-primary text-dl-primary":"border-dl-border text-slate-400 hover:text-white"}`,children:"Time Window"}),e.jsx("button",{onClick:()=>t({grouping:{...s.grouping||o,mode:"event"}}),className:`flex-1 py-1.5 text-xs rounded border transition-colors ${((D=s.grouping)==null?void 0:D.mode)==="event"?"bg-dl-primary/20 border-dl-primary text-dl-primary":"border-dl-border text-slate-400 hover:text-white"}`,children:"Trigger Events"})]}),((P=s.grouping)==null?void 0:P.mode)==="time"&&e.jsx("div",{className:"flex gap-1.5",children:[200,500,1e3].map(r=>{var a;return e.jsxs("button",{onClick:()=>t({grouping:{...s.grouping||o,timeWindowMs:r}}),className:`flex-1 py-1 text-xs rounded border transition-colors ${((a=s.grouping)==null?void 0:a.timeWindowMs)===r?"bg-dl-accent/20 border-dl-accent text-dl-accent":"border-dl-border text-slate-400 hover:text-white"}`,children:[r,"ms"]},r)})}),((A=s.grouping)==null?void 0:A.mode)==="event"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-[10px] text-slate-500",children:"Events that start a new group:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:(((M=s.grouping)==null?void 0:M.triggerEvents)||o.triggerEvents).map(r=>e.jsxs("span",{className:"inline-flex items-center gap-1 px-1.5 py-0.5 rounded text-[10px] bg-dl-primary/20 text-dl-primary",children:[r,e.jsx("button",{onClick:()=>$(r),className:"hover:text-white",children:e.jsx(b,{className:"w-2.5 h-2.5"})})]},r))}),q?e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("input",{type:"text",value:u,onChange:r=>N(r.target.value),onKeyDown:r=>{r.key==="Enter"&&u?E(u):r.key==="Escape"&&(j(!1),N(""))},placeholder:"Event name...",className:"w-full bg-dl-card border border-dl-border rounded px-2 py-1 text-xs text-white placeholder:text-slate-500 focus:border-dl-primary focus:outline-none",autoFocus:!0}),e.jsx("div",{className:"flex flex-wrap gap-1",children:ae.filter(r=>{var a;return r.toLowerCase().includes(u.toLowerCase())&&!(((a=s.grouping)==null?void 0:a.triggerEvents)||o.triggerEvents).includes(r)}).map(r=>e.jsx("button",{onClick:()=>E(r),className:"px-1.5 py-0.5 text-[10px] rounded bg-dl-card border border-dl-border text-slate-400 hover:text-white hover:border-dl-primary transition-colors",children:r},r))})]}):e.jsxs("button",{onClick:()=>j(!0),className:"flex items-center gap-1 text-xs text-slate-400 hover:text-dl-primary transition-colors",children:[e.jsx(O,{className:"w-3 h-3"}),"Add trigger event"]})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("h3",{className:"text-xs font-medium text-slate-400 uppercase tracking-wider",children:"Performance"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-xs text-slate-300",children:"Max Events"}),e.jsx("span",{className:"text-xs text-dl-accent font-mono",children:s.maxEvents})]}),e.jsx("input",{type:"range",min:"10",max:"200",step:"10",value:s.maxEvents,onChange:r=>t({maxEvents:Number(r.target.value)}),className:"w-full accent-dl-primary h-1"})]})]}),e.jsx("div",{className:"pt-4 mt-4 border-t border-dl-border",children:e.jsx(W,{})})]})]})]})})}function d({icon:y,label:x,description:s,checked:m,onChange:p}){return e.jsxs("div",{className:"flex items-center justify-between bg-dl-card rounded px-3 py-2 border border-dl-border",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[y,e.jsxs("div",{children:[e.jsx("span",{className:"text-xs text-white",children:x}),s&&e.jsx("span",{className:"text-[10px] text-slate-500 block",children:s})]})]}),e.jsx(l.button,{onClick:p,className:`relative w-8 h-5 rounded-full transition-colors ${m?"bg-gradient-to-r from-dl-primary to-dl-secondary":"bg-dl-border"}`,whileTap:{scale:.95},children:e.jsx(l.div,{className:"absolute top-0.5 w-4 h-4 bg-white rounded-full shadow-md",animate:{left:m?14:2},transition:{type:"spring",stiffness:500,damping:30}})})]})}te.__docgenInfo={description:"",methods:[],displayName:"SettingsDrawer",props:{isOpen:{required:!0,tsType:{name:"boolean"},description:""},onClose:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},settings:{required:!0,tsType:{name:"Settings"},description:""},onUpdateSettings:{required:!0,tsType:{name:"signature",type:"function",raw:"(updates: Partial<Settings>) => void",signature:{arguments:[{type:{name:"Partial",elements:[{name:"Settings"}],raw:"Partial<Settings>"},name:"updates"}],return:{name:"void"}}},description:""},activeTabId:{required:!0,tsType:{name:"union",raw:"number | null",elements:[{name:"number"},{name:"null"}]},description:""},eventCount:{required:!1,tsType:{name:"number"},description:""},onExport:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};export{re as D,te as S};
