import{j as t}from"./jsx-runtime-D_zvdyIk.js";import{r as o}from"./iframe-d2sodY_R.js";import{D as ne,c as ae,g as oe,b as le}from"./index-YHEJibdA.js";import{E as X}from"./EventRow-2ufClljE.js";import{D as ie,S as de}from"./SettingsDrawer-B0USm2rV.js";import{T as ce}from"./Toast-Dd3ZanNs.js";import{m as j}from"./proxy-oLp51Ffe.js";import{L as pe,S as ue}from"./zap-BOWfXx7X.js";import{c as _}from"./createLucideIcon-B5oPKDXb.js";import{C as J,a as xe}from"./clock-DWTjRa6l.js";import{D as ge}from"./download-DQ1P-CAn.js";import{T as me}from"./trash-2-CcuZx_2c.js";import{S as he}from"./search-B462KUoz.js";import{X as Y}from"./x-gYhyWlMT.js";import{F as fe}from"./filter-iGNtTwyB.js";import{C as ve}from"./chevron-down-BNRKPvBn.js";import{A as K}from"./index-pUis7lPG.js";import{P as be}from"./plus-BsDFT6l8.js";import"./preload-helper-Dp1pzeXC.js";import"./JsonHighlight-q1P6TuIy.js";import"./SupportLink-C9YXK4qC.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=_("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const we=_("FolderOpen",[["path",{d:"m6 14 1.5-2.9A2 2 0 0 1 9.24 10H20a2 2 0 0 1 1.94 2.5l-1.54 6a2 2 0 0 1-1.95 1.5H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h3.9a2 2 0 0 1 1.69.9l.81 1.2a2 2 0 0 0 1.67.9H18a2 2 0 0 1 2 2v2",key:"usdka0"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=_("Folder",[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=_("Grid3x3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);function Q(){return typeof navigator<"u"&&typeof navigator.clipboard<"u"&&typeof navigator.clipboard.writeText=="function"}async function Ne(y){try{return await navigator.clipboard.writeText(y),{success:!0}}catch(e){return{success:!1,error:e instanceof Error?e.message:"Clipboard API failed"}}}function je(y){try{const e=document.createElement("textarea");e.value=y,e.style.position="fixed",e.style.opacity="0",e.style.pointerEvents="none",e.setAttribute("aria-hidden","true"),document.body.appendChild(e),e.select();const r=document.execCommand("copy");return document.body.removeChild(e),r?{success:!0}:{success:!1,error:"execCommand copy failed"}}catch(e){return{success:!1,error:e instanceof Error?e.message:"execCommand failed"}}}async function Se(y){if(Q()){const e=await Ne(y);if(e.success)return e}return je(y)}const S=typeof browser<"u"?browser:chrome,T=50;function Te(y){var Z,z,B;const[e,r]=o.useState([]),[d,s]=o.useState(ne),[E,m]=o.useState(""),[F,M]=o.useState(new Set),[k,n]=o.useState(null),[g,C]=o.useState(!1),[p,N]=o.useState(0),[L,P]=o.useState(new Set),[I,G]=o.useState(null),[D,U]=o.useState(new Set),[R,V]=o.useState(!1),[H,O]=o.useState(null),W=o.useRef(!1),q=o.useRef(0),b=((z=(Z=S.devtools)==null?void 0:Z.inspectedWindow)==null?void 0:z.tabId)??null,i=o.useCallback(async l=>{try{const a=await S.tabs.sendMessage(l,{type:"GET_EVENTS"});if(a!=null&&a.events){const x=[...a.events].sort((f,v)=>v.timestamp-f.timestamp);q.current+=1,r(x),N(0)}}catch(a){console.debug("Could not load events:",a)}},[]);o.useEffect(()=>{if(!b)return;const l=(a,x)=>{a===b&&x.status==="loading"&&x.url&&(r([]),N(0),M(new Set)),a===b&&x.status==="complete"&&i(b)};return S.tabs.onUpdated.addListener(l),()=>{S.tabs.onUpdated.removeListener(l)}},[b,i]),o.useEffect(()=>{(async()=>{try{const x=(await S.storage.local.get("datalayer_monitor_settings")).datalayer_monitor_settings;x&&s(f=>({...f,...x}))}catch(a){console.debug("Could not load settings from storage:",a)}})()},[]),o.useEffect(()=>{b&&i(b)},[b,i]),o.useEffect(()=>{const l=(a,x)=>{if(a.type==="DATALAYER_EVENT"||a.type==="EVENT_ADDED"){if(W.current)return;if(a.payload&&!Array.isArray(a.payload)){const f=a.payload;r(v=>v.some(h=>h.id===f.id)?v:[f,...v].slice(0,1e3)),P(v=>new Set(v).add(f.id)),setTimeout(()=>{P(v=>{const h=new Set(v);return h.delete(f.id),h})},2e3)}}else if(a.type==="SETTINGS_UPDATED")a.payload&&s(f=>({...f,...a.payload}));else if(a.type==="EVENTS_UPDATED"&&a.payload&&Array.isArray(a.payload)){const f=[...a.payload].sort((v,h)=>h.timestamp-v.timestamp);r(f)}};return S.runtime.onMessage.addListener(l),()=>{S.runtime.onMessage.removeListener(l)}},[b]),o.useEffect(()=>{const l=(a,x)=>{if(x==="local"&&a.datalayer_monitor_settings){const f=a.datalayer_monitor_settings.newValue;f&&s(v=>({...v,...f}))}};return S.storage.onChanged.addListener(l),()=>{S.storage.onChanged.removeListener(l)}},[]);const c=o.useMemo(()=>{let l=e;if(E.trim()){const a=E.toLowerCase();l=l.filter(x=>x.event.toLowerCase().includes(a)||JSON.stringify(x.data).toLowerCase().includes(a))}return d.eventFilters.length>0&&(d.filterMode==="include"?l=l.filter(a=>d.eventFilters.some(x=>a.event.toLowerCase().includes(x.toLowerCase()))):l=l.filter(a=>!d.eventFilters.some(x=>a.event.toLowerCase().includes(x.toLowerCase())))),l},[e,E,d.eventFilters,d.filterMode]),u=o.useMemo(()=>{const l=new Set(e.map(a=>a.event));return Array.from(l).sort()},[e]),w=o.useMemo(()=>{const l=new Set(e.map(a=>a.source.replace(" (persisted)","").replace("(persisted)","")));return Array.from(l)},[e]);o.useEffect(()=>{if(w.length>0&&b){const l=ae(w,d.sourceColors||{});l&&(s(a=>({...a,sourceColors:l})),S.tabs.sendMessage(b,{type:"UPDATE_SETTINGS",payload:{sourceColors:l}}).catch(()=>{}))}},[w,d.sourceColors,b]);const $=o.useMemo(()=>{var v;if(!((v=d.grouping)!=null&&v.enabled)||c.length===0)return[];const l=[];let a=null,x=0;const f=[...c].reverse();for(const h of f)(a?d.grouping.mode==="time"?h.timestamp-x>d.grouping.timeWindowMs:d.grouping.triggerEvents.some(re=>h.event.toLowerCase().includes(re.toLowerCase())):!0)?(a={id:`group-${h.id}`,events:[h],startTime:h.timestamp,endTime:h.timestamp,triggerEvent:d.grouping.mode==="event"?h.event:void 0,collapsed:!1},l.push(a)):a&&(a.events.push(h),a.endTime=h.timestamp),x=h.timestamp;return l.forEach(h=>h.events.reverse()),l.reverse(),l},[c,d.grouping]),ee=(B=d.grouping)!=null&&B.enabled?Math.ceil($.length/T):Math.ceil(c.length/T),te=o.useMemo(()=>{const l=p*T;return c.slice(l,l+T)},[c,p]),se=o.useMemo(()=>{const l=p*T;return $.slice(l,l+T)},[$,p]);return o.useEffect(()=>{if(!I)return;const l=()=>{G(null)},a=setTimeout(()=>{document.addEventListener("click",l)},0);return()=>{clearTimeout(a),document.removeEventListener("click",l)}},[I]),{events:e,settings:d,tabId:b,searchText:E,expandedEvents:F,copiedId:k,showFilters:g,currentPage:p,newEventIds:L,filterMenuEvent:I,collapsedGroups:D,showSettings:R,copyError:H,filteredEvents:c,eventGroups:$,availableEventTypes:u,uniqueSources:w,totalPages:ee,paginatedEvents:te,paginatedGroups:se,setEvents:r,setSettings:s,setSearchText:m,setExpandedEvents:M,setCopiedId:n,setShowFilters:C,setShowSettings:V,setCurrentPage:N,setNewEventIds:P,setFilterMenuEvent:G,setCollapsedGroups:U,setCopyError:O}}const A=typeof browser<"u"?browser:chrome;function Fe(y){const{context:e,tabId:r,settings:d,filteredEvents:s,setEvents:E,setSettings:m,setExpandedEvents:F,setCopiedId:M,setNewEventIds:k,setCurrentPage:n,setFilterMenuEvent:g,setCollapsedGroups:C,setCopyError:p}=y,N=o.useRef(!1),L=o.useCallback(async()=>{if(r){N.current=!0,E([]),k(new Set),F(new Set),n(0);try{await A.tabs.sendMessage(r,{type:"CLEAR_EVENTS"})}catch(i){console.error("Failed to clear events:",i)}setTimeout(()=>{N.current=!1},1e3)}},[r,E,k,F,n]),P=o.useCallback(i=>{F(c=>{const u=new Set(c);return u.has(i)?u.delete(i):u.add(i),u})},[F]),I=o.useCallback(async i=>{const c=JSON.stringify(i.data,null,2),u=await Se(c);u.success?(M(i.id),p(null),setTimeout(()=>M(null),2e3)):e==="devtools"&&(p(u.error||"Copy failed"),setTimeout(()=>p(null),3e3))},[e,M,p]),G=o.useCallback(async()=>{const i=!d.persistEvents;m(c=>({...c,persistEvents:i})),r&&A.tabs.sendMessage(r,{type:"UPDATE_SETTINGS",payload:{persistEvents:i}}).catch(()=>{})},[d.persistEvents,r,m]),D=o.useCallback(async()=>{var c;const i=!((c=d.grouping)!=null&&c.enabled);m(u=>({...u,grouping:{...u.grouping,enabled:i}})),r&&A.tabs.sendMessage(r,{type:"UPDATE_SETTINGS",payload:{grouping:{...d.grouping,enabled:i}}}).catch(()=>{})},[d.grouping,r,m]),U=o.useCallback(async()=>{const i=!d.consoleLogging;m(c=>({...c,consoleLogging:i})),r&&A.tabs.sendMessage(r,{type:"UPDATE_SETTINGS",payload:{consoleLogging:i}}).catch(()=>{})},[d.consoleLogging,r,m]),R=o.useCallback((i,c)=>{if(d.eventFilters.includes(i))return;const w={eventFilters:[...d.eventFilters,i],filterMode:c};m($=>({...$,...w})),r&&A.tabs.sendMessage(r,{type:"UPDATE_SETTINGS",payload:w}).catch(()=>{}),g(null)},[d.eventFilters,r,m,g]),V=o.useCallback(i=>{const c=d.eventFilters.filter(u=>u!==i);m(u=>({...u,eventFilters:c})),r&&A.tabs.sendMessage(r,{type:"UPDATE_SETTINGS",payload:{eventFilters:c}}).catch(()=>{})},[d.eventFilters,r,m]),H=o.useCallback(()=>{const i=d.filterMode==="include"?"exclude":"include";m(c=>({...c,filterMode:i})),r&&A.tabs.sendMessage(r,{type:"UPDATE_SETTINGS",payload:{filterMode:i}}).catch(()=>{})},[d.filterMode,r,m]),O=o.useCallback(i=>{m(c=>({...c,...i}))},[m]),W=o.useCallback(()=>{const i=JSON.stringify(s,null,2),c=new Blob([i],{type:"application/json"}),u=URL.createObjectURL(c),w=document.createElement("a");w.href=u,w.download=`datalayer-events-${new Date().toISOString()}.json`,w.click(),URL.revokeObjectURL(u)},[s]),q=o.useCallback(i=>{C(c=>{const u=new Set(c);return u.has(i)?u.delete(i):u.add(i),u})},[C]),b=o.useCallback(i=>{const c=i.replace(" (persisted)","").replace("(persisted)","");return oe(c,d.sourceColors||{})},[d.sourceColors]);return{clearEvents:L,toggleExpanded:P,copyEvent:I,togglePersist:G,toggleGrouping:D,toggleConsoleLogging:U,addFilter:R,removeFilter:V,toggleFilterMode:H,handleUpdateSettings:O,exportEvents:W,toggleGroupCollapsed:q,getSourceColorForEvent:b}}function Me({context:y}){var m,F,M,k;const e=Te(),r=Fe({context:y,tabId:e.tabId,settings:e.settings,filteredEvents:e.filteredEvents,setEvents:e.setEvents,setSettings:e.setSettings,setExpandedEvents:e.setExpandedEvents,setCopiedId:e.setCopiedId,setNewEventIds:e.setNewEventIds,setCurrentPage:e.setCurrentPage,setFilterMenuEvent:e.setFilterMenuEvent,setCollapsedGroups:e.setCollapsedGroups,setCopyError:e.setCopyError}),d=Q(),s=e.settings.compactMode,E=o.useMemo(()=>{const n={};for(const g of e.events)n[g.event]=(n[g.event]||0)+1;return n},[e.events]);return t.jsxs("div",{className:"h-screen flex flex-col bg-dl-darker text-slate-200 overflow-hidden",children:[t.jsx("header",{className:`flex-shrink-0 bg-gradient-to-r from-dl-dark to-dl-darker border-b border-dl-border ${s?"px-3 py-2":"devtools-header px-4 py-3"}`,children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(j.div,{whileHover:s?void 0:{rotate:180},transition:{duration:.3},className:`bg-gradient-to-br from-dl-primary to-dl-secondary rounded-lg flex items-center justify-center ${s?"w-6 h-6":"w-8 h-8"}`,children:t.jsx(pe,{className:s?"w-3 h-3 text-white":"w-4 h-4 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:`font-semibold text-white ${s?"text-sm":"font-bold"}`,children:"DataLayer Lens"}),!s&&t.jsxs("p",{className:"text-xs text-slate-500",children:[e.filteredEvents.length," events"]})]}),s&&t.jsx("span",{className:"px-2 py-0.5 bg-dl-primary/20 text-dl-primary text-xs rounded-full font-medium",children:e.filteredEvents.length})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsxs(j.button,{onClick:r.toggleGrouping,className:s?`p-1.5 rounded-lg transition-colors ${(m=e.settings.grouping)!=null&&m.enabled?"bg-dl-primary/20 text-dl-primary":"text-slate-400 hover:text-slate-200 hover:bg-dl-card"}`:`header-btn ${(F=e.settings.grouping)!=null&&F.enabled?"bg-dl-primary/20 text-dl-primary":"bg-dl-card text-slate-400 hover:text-slate-200"}`,whileHover:{scale:s?1.05:1.02},whileTap:{scale:s?.95:.98},title:"Toggle grouping",children:[t.jsx(Ce,{className:s?"w-4 h-4":"btn-icon"}),!s&&t.jsx("span",{className:"btn-label",children:"Group"})]}),t.jsxs(j.button,{onClick:r.togglePersist,className:s?`p-1.5 rounded-lg transition-colors ${e.settings.persistEvents?"bg-dl-primary/20 text-dl-primary":"text-slate-400 hover:text-slate-200 hover:bg-dl-card"}`:`header-btn ${e.settings.persistEvents?"bg-dl-primary/20 text-dl-primary":"bg-dl-card text-slate-400 hover:text-slate-200"}`,whileHover:{scale:s?1.05:1.02},whileTap:{scale:s?.95:.98},title:"Persist events on refresh",children:[t.jsx(J,{className:s?"w-4 h-4":"btn-icon"}),!s&&t.jsx("span",{className:"btn-label",children:"Persist"})]}),t.jsxs(j.button,{onClick:r.exportEvents,className:s?"p-1.5 text-slate-400 hover:text-slate-200 hover:bg-dl-card rounded-lg transition-colors":"header-btn hide-md bg-dl-card hover:bg-dl-border text-slate-300",whileHover:{scale:s?1.05:1.02},whileTap:{scale:s?.95:.98},title:"Export events",disabled:e.filteredEvents.length===0,children:[t.jsx(ge,{className:s?"w-4 h-4":"btn-icon"}),!s&&t.jsx("span",{className:"btn-label",children:"Export"})]}),t.jsxs(j.button,{onClick:r.clearEvents,className:s?"p-1.5 text-slate-400 hover:text-dl-error hover:bg-dl-error/10 rounded-lg transition-colors":"header-btn bg-dl-error/10 hover:bg-dl-error/20 text-dl-error",whileHover:{scale:s?1.05:1.02},whileTap:{scale:s?.95:.98},title:"Clear all events",children:[t.jsx(me,{className:s?"w-4 h-4":"btn-icon"}),!s&&t.jsx("span",{className:"btn-label",children:"Clear"})]}),t.jsx(j.button,{onClick:()=>e.setShowSettings(!0),className:s?"p-1.5 text-slate-400 hover:text-slate-200 hover:bg-dl-card rounded-lg transition-colors":"header-btn bg-dl-card hover:bg-dl-border text-slate-300",whileHover:{scale:s?1.05:1.02},whileTap:{scale:s?.95:.98},title:"Open settings",children:t.jsx(ue,{className:s?"w-4 h-4":"btn-icon"})})]})]})}),t.jsxs("div",{className:`flex-shrink-0 bg-dl-dark border-b border-dl-border space-y-2 ${s?"px-3 py-2":"search-filter-bar px-4 py-3"}`,children:[t.jsxs("div",{className:`flex items-center ${s?"gap-2":"gap-3"}`,children:[t.jsxs("div",{className:"relative flex-1 min-w-0",children:[t.jsx(he,{className:`absolute top-1/2 -translate-y-1/2 text-slate-500 ${s?"left-2.5 w-3.5 h-3.5":"left-3 w-4 h-4"}`}),t.jsx("input",{type:"text",value:e.searchText,onChange:n=>e.setSearchText(n.target.value),placeholder:"Search events...",className:`w-full bg-dl-card border border-dl-border rounded-lg text-white placeholder:text-slate-500 focus:border-dl-primary focus:outline-none focus:ring-1 focus:ring-dl-primary/50 ${s?"pl-8 pr-7 py-1.5 text-xs":"pl-10 pr-8 py-2 text-sm"}`}),e.searchText&&t.jsx("button",{onClick:()=>e.setSearchText(""),className:`absolute top-1/2 -translate-y-1/2 p-0.5 hover:bg-dl-border rounded text-slate-400 hover:text-slate-200 ${s?"right-2":"right-3"}`,children:t.jsx(Y,{className:s?"w-3 h-3":"w-3.5 h-3.5"})})]}),t.jsxs(j.button,{onClick:()=>e.setShowFilters(!e.showFilters),className:`rounded-lg font-medium flex items-center gap-1 transition-colors ${e.showFilters||e.settings.eventFilters.length>0?"bg-dl-primary/20 text-dl-primary":"bg-dl-card text-slate-400 hover:text-slate-200"} ${s?"p-1.5 text-xs":"px-3 py-2 text-xs gap-1.5"}`,whileHover:{scale:1.02},whileTap:{scale:.98},title:"Toggle filters",children:[t.jsx(fe,{className:"w-3.5 h-3.5"}),!s&&t.jsx("span",{className:"filter-label",children:"Filters"}),e.settings.eventFilters.length>0&&t.jsx("span",{className:`bg-dl-primary text-white rounded-full min-w-[16px] text-center ${s?"px-1 py-0.5 text-[10px]":"px-1.5 py-0.5 text-[10px]"}`,children:e.settings.eventFilters.length}),e.showFilters?t.jsx(ye,{className:"w-3 h-3"}):t.jsx(ve,{className:"w-3 h-3"})]})]}),t.jsx(K,{children:e.showFilters&&t.jsx(j.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:t.jsxs("div",{className:`space-y-2 ${s?"pt-1":"pt-2 space-y-3"}`,children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("span",{className:`text-slate-500 uppercase tracking-wider ${s?"text-[10px]":"text-xs"}`,children:"Mode:"}),t.jsx("button",{onClick:r.toggleFilterMode,className:`rounded font-medium transition-colors ${e.settings.filterMode==="include"?"bg-dl-success/20 text-dl-success":"bg-dl-error/20 text-dl-error"} ${s?"px-2 py-0.5 text-[10px]":"px-2.5 py-1 text-xs"}`,children:e.settings.filterMode==="include"?"Include only":"Exclude"})]}),e.settings.eventFilters.length>0&&t.jsx("div",{className:`flex flex-wrap ${s?"gap-1":"gap-1.5"}`,children:e.settings.eventFilters.map(n=>{const g=E[n]||0;return t.jsxs("span",{className:`inline-flex items-center gap-1 rounded-full font-medium ${e.settings.filterMode==="include"?"bg-dl-success/20 text-dl-success":"bg-dl-error/20 text-dl-error"} ${s?"px-2 py-0.5 text-[10px]":"px-2.5 py-1 text-xs"}`,children:[n,t.jsxs("span",{className:`opacity-60 ${s?"text-[9px]":"text-[10px]"}`,children:["(",g,")"]}),t.jsx("button",{onClick:()=>r.removeFilter(n),className:"hover:bg-white/10 rounded-full p-0.5",children:t.jsx(Y,{className:s?"w-2.5 h-2.5":"w-3 h-3"})})]},n)})}),t.jsxs("div",{className:s?"space-y-1":"space-y-1.5",children:[t.jsx("span",{className:`text-slate-500 uppercase tracking-wider ${s?"text-[10px]":"text-xs"}`,children:"Add filter from captured events:"}),t.jsx("div",{className:`flex flex-wrap overflow-y-auto ${s?"gap-1 max-h-24":"gap-1.5 max-h-28"}`,children:e.availableEventTypes.filter(n=>!e.settings.eventFilters.includes(n)).map(n=>{const g=le(n),C=E[n]||0;return t.jsxs("button",{onClick:()=>r.addFilter(n,e.settings.filterMode),className:`inline-flex items-center gap-1 rounded-full font-medium opacity-70 hover:opacity-100 transition-opacity ${s?"px-2 py-0.5 text-[10px]":"px-2.5 py-1 text-xs"}`,style:{backgroundColor:`${g.color}20`,color:g.color},children:[t.jsx(be,{className:s?"w-2.5 h-2.5":"w-3 h-3"}),n,t.jsxs("span",{className:`opacity-60 ${s?"text-[9px]":"text-[10px]"}`,children:["(",C,")"]})]},n)})})]})]})})})]}),t.jsx("div",{className:"flex-1 overflow-y-auto",children:e.filteredEvents.length===0?t.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-slate-500",children:[t.jsx(ie,{className:s?"w-10 h-10 mb-3 opacity-30":"w-12 h-12 mb-4 opacity-30"}),t.jsx("p",{className:s?"text-sm font-medium":"text-lg font-medium",children:"No events captured"}),t.jsx("p",{className:s?"text-xs":"text-sm",children:"Waiting for dataLayer pushes..."})]}):(M=e.settings.grouping)!=null&&M.enabled?t.jsx("div",{className:"divide-y divide-dl-border",children:e.paginatedGroups.map(n=>{const g=e.collapsedGroups.has(n.id),C=new Date(n.startTime).toLocaleTimeString();return t.jsxs("div",{className:"bg-dl-dark/30",children:[t.jsxs("div",{onClick:()=>r.toggleGroupCollapsed(n.id),className:`flex items-center cursor-pointer hover:bg-dl-card/50 border-l-2 border-dl-primary/50 ${s?"gap-2 px-3 py-2":"gap-3 px-4 py-3"}`,children:[t.jsx(j.div,{animate:{rotate:g?0:90},transition:{duration:.15},children:t.jsx(xe,{className:s?"w-3.5 h-3.5 text-slate-500":"w-4 h-4 text-slate-500"})}),g?t.jsx(Ee,{className:s?"w-4 h-4 text-dl-primary":"w-5 h-5 text-dl-primary"}):t.jsx(we,{className:s?"w-4 h-4 text-dl-primary":"w-5 h-5 text-dl-primary"}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsxs("span",{className:`font-medium text-slate-300 ${s?"text-xs":"text-sm"}`,children:[n.events.length," event",n.events.length!==1?"s":""]}),n.triggerEvent&&t.jsxs("span",{className:`text-dl-primary truncate ${s?"text-[10px]":"text-xs"}`,children:["triggered by ",n.triggerEvent]})]}),t.jsxs("div",{className:`flex items-center gap-1.5 text-slate-500 ${s?"text-[10px]":"text-xs"}`,children:[t.jsx(J,{className:s?"w-2.5 h-2.5":"w-3 h-3"}),C]})]})]}),t.jsx(K,{children:!g&&t.jsx(j.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},className:"overflow-hidden",children:t.jsx("div",{className:`border-l-2 border-dl-primary/20 ${s?"pl-4 ml-3":"pl-6 ml-4"}`,children:n.events.map(p=>t.jsx(X,{event:p,isExpanded:e.expandedEvents.has(p.id),isCopied:e.copiedId===p.id,isNew:e.newEventIds.has(p.id),showFilterMenu:e.filterMenuEvent===p.id,compact:s,showTimestamps:e.settings.showTimestamps,sourceColor:r.getSourceColorForEvent(p.source),onToggle:()=>r.toggleExpanded(p.id),onCopy:d?()=>r.copyEvent(p):void 0,onAddFilterInclude:()=>r.addFilter(p.event,"include"),onAddFilterExclude:()=>r.addFilter(p.event,"exclude"),onToggleFilterMenu:()=>e.setFilterMenuEvent(N=>N===p.id?null:p.id)},p.id))})})})]},n.id)})}):t.jsx("div",{className:"divide-y divide-dl-border",children:e.paginatedEvents.map((n,g)=>{const C=n.source.includes("(persisted)"),p=g>0?e.paginatedEvents[g-1]:null,N=p==null?void 0:p.source.includes("(persisted)"),L=e.settings.persistEvents&&C&&!N&&g>0;return t.jsxs("div",{children:[L&&t.jsxs("div",{className:"flex items-center gap-3 py-3 px-4 bg-dl-card/30",children:[t.jsx("div",{className:"flex-1 h-px bg-dl-border"}),t.jsxs("span",{className:`text-slate-500 font-medium uppercase tracking-wider flex items-center gap-1.5 ${s?"text-[10px]":"text-xs"}`,children:[t.jsx(J,{className:"w-3 h-3"}),"Persisted Events"]}),t.jsx("div",{className:"flex-1 h-px bg-dl-border"})]}),t.jsx(X,{event:n,isExpanded:e.expandedEvents.has(n.id),isCopied:e.copiedId===n.id,isNew:e.newEventIds.has(n.id),showFilterMenu:e.filterMenuEvent===n.id,compact:s,showTimestamps:e.settings.showTimestamps,sourceColor:r.getSourceColorForEvent(n.source),onToggle:()=>r.toggleExpanded(n.id),onCopy:d?()=>r.copyEvent(n):void 0,onAddFilterInclude:()=>r.addFilter(n.event,"include"),onAddFilterExclude:()=>r.addFilter(n.event,"exclude"),onToggleFilterMenu:()=>e.setFilterMenuEvent(P=>P===n.id?null:n.id)})]},n.id)})})}),e.totalPages>1&&t.jsxs("div",{className:`flex-shrink-0 flex items-center justify-center bg-dl-dark border-t border-dl-border ${s?"gap-3 px-3 py-2":"gap-4 px-4 py-3"}`,children:[t.jsx("button",{onClick:()=>e.setCurrentPage(n=>Math.max(0,n-1)),disabled:e.currentPage===0,className:`bg-dl-card hover:bg-dl-border disabled:opacity-30 disabled:cursor-not-allowed rounded text-slate-300 transition-colors ${s?"px-2 py-1 text-xs":"px-3 py-1.5 rounded-lg text-xs"}`,children:"← Prev"}),t.jsx("span",{className:`text-slate-400 ${s?"text-xs":"text-sm"}`,children:(k=e.settings.grouping)!=null&&k.enabled?t.jsxs(t.Fragment,{children:[e.currentPage*T+1,"-",Math.min((e.currentPage+1)*T,e.eventGroups.length)," of"," ",e.eventGroups.length," groups"]}):t.jsxs(t.Fragment,{children:[e.currentPage*T+1,"-",Math.min((e.currentPage+1)*T,e.filteredEvents.length)," of"," ",e.filteredEvents.length]})}),t.jsx("button",{onClick:()=>e.setCurrentPage(n=>Math.min(e.totalPages-1,n+1)),disabled:e.currentPage>=e.totalPages-1,className:`bg-dl-card hover:bg-dl-border disabled:opacity-30 disabled:cursor-not-allowed rounded text-slate-300 transition-colors ${s?"px-2 py-1 text-xs":"px-3 py-1.5 rounded-lg text-xs"}`,children:"Next →"})]}),t.jsx(de,{isOpen:e.showSettings,onClose:()=>e.setShowSettings(!1),settings:e.settings,onUpdateSettings:r.handleUpdateSettings,activeTabId:e.tabId,eventCount:e.filteredEvents.length,onExport:r.exportEvents}),t.jsx(ce,{message:e.copyError,type:"error"})]})}Me.__docgenInfo={description:"",methods:[],displayName:"EventPanel",props:{context:{required:!0,tsType:{name:"literal",value:"'devtools'"},description:"Context determines UI differences - devtools is the only supported mode"}}};export{Me as EventPanel,T as PAGE_SIZE,Fe as useEventPanelActions,Te as useEventPanelState};
